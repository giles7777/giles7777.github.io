{"ast":null,"code":"import _objectSpread from\"C:\\\\cygwin64\\\\home\\\\giles\\\\projs\\\\personal\\\\getalife\\\\website\\\\giles7777.github.io\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:\\\\cygwin64\\\\home\\\\giles\\\\projs\\\\personal\\\\getalife\\\\website\\\\giles7777.github.io\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\cygwin64\\\\home\\\\giles\\\\projs\\\\personal\\\\getalife\\\\website\\\\giles7777.github.io\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\cygwin64\\\\home\\\\giles\\\\projs\\\\personal\\\\getalife\\\\website\\\\giles7777.github.io\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\cygwin64\\\\home\\\\giles\\\\projs\\\\personal\\\\getalife\\\\website\\\\giles7777.github.io\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\cygwin64\\\\home\\\\giles\\\\projs\\\\personal\\\\getalife\\\\website\\\\giles7777.github.io\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component,memo}from\"react\";import*as THREE from\"three\";import{OrbitControls}from\"three/examples/jsm/controls/OrbitControls\";import{World}from\"./World\";import{ConwayAgent,ConwayControl}from\"./ConwayAgent\";import SimControl from\"./SimControl\";import CameraControl from\"./CameraControl\";var style={height:512,maxWidth:1024};var delta=0;var clock=new THREE.Clock();var interval=1/30;var transmissionDelayMax=0;// ms max\nvar App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={};_this.debugNetwork=false;_this.debugNeighbors=false;_this.showNeighborsFor=-1;_this.messages=[];_this.simPaused=true;_this.pauseTime=Number.MAX_SAFE_INTEGER;_this.time=0;_this.lastLoopTime=new Date().getTime();_this.agentParams={startPattern:\"test\",size:10,cycleTime:400,stateSendTime:50,spontaneousGeneration:0.001*0,resurrectionChance:0.5*0};_this.worldSetup=function(){_this.world=new World();};_this.agentSetup=function(params){var id=0;var random=false;var chance=0.4;var quadpole=[[0,0,0,0,0,0,0,0,0,0],[0,1,1,0,0,0,0,0,0,0],[0,1,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,1,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,0,1,0,0],[0,0,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];var blank=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];var corners=[[1,1,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,1],[1,1,0,0,0,0,0,0,1,1]];var cool1=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,0,0,0,0],[0,0,0,1,1,1,1,0,0,0],[0,0,0,0,1,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];var toad=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,1,0,0,0],[0,0,0,1,1,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];var blinker=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0],[0,0,0,0,0,1,0,0,0,0],[0,0,0,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];var beacon=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,0,0,0,0,0],[0,0,0,1,1,0,0,0,0,0],[0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];var pulsar=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],[0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],[0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],[0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0],[0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],[0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],[0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];var test=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,0,0,0,0,0],[0,0,0,1,1,0,0,0,0,0],[0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]];var pattern;if(params.startPattern===\"random\"){random=true;}else{switch(params.startPattern){case\"quadpole\":pattern=quadpole;break;case\"blank\":pattern=blank;break;case\"test\":pattern=test;break;case\"corners\":pattern=corners;break;case\"toad\":pattern=toad;break;case\"beacon\":pattern=beacon;break;case\"blinker\":pattern=blinker;break;case\"pulsar\":pattern=pulsar;break;default:console.log(\"Unknown pattern\");pattern=test;break;}}var size=params.size;if(size<pattern.length){size=pattern.length;}_this.agents=[];for(var y=0;y<size;y++){for(var x=0;x<size;x++){var alive=true;var px=x;var py=y;if(random){alive=Math.random()<chance;}else{px=x;py=size-y-1;alive=pattern[y][x]===1;}var agent=new ConwayAgent(THREE,_assertThisInitialized(_this),id++,_this.world,0.1,px-size/2,py-size/2,0,Math.PI/2,0,0,params,alive);//console.log(\"agent: \" + (id-1) + \" id: \" + (y * size + x) + \" x: \" + x + \" y: \" + y + \" alive: \" + alive);\n_this.agents[y*size+x]=agent;}}};_this.sceneSetup=function(){// get container dimensions and use them for scene sizing\nvar width=_this.el.clientWidth;var height=_this.el.clientHeight;_this.scene=new THREE.Scene();_this.camera=new THREE.PerspectiveCamera(75,// fov = field of view\nwidth/height,// aspect ratio\n0.1,// near plane\n1000.0// far plane\n);_this.camera.position.z=10;// is used here to set some distance from a cube that is located at z = 0\n// OrbitControls allow a camera to orbit around the object\n// https://threejs.org/docs/#examples/controls/OrbitControls\n_this.controls=new OrbitControls(_this.camera,_this.el);_this.renderer=new THREE.WebGLRenderer();_this.renderer.setSize(width,height);_this.el.appendChild(_this.renderer.domElement);// mount using React ref\n};_this.addCustomSceneObjects=function(){for(var n=0;n<_this.agents.length;n++){_this.scene.add(_this.agents[n].getMesh());}_this.calcAgentNeighbors(8);var lights=[];lights[0]=new THREE.PointLight(0xffffff,1,0);lights[1]=new THREE.PointLight(0xffffff,1,0);lights[2]=new THREE.PointLight(0xffffff,1,0);lights[0].position.set(0,200,0);lights[1].position.set(100,200,100);lights[2].position.set(-100,-200,-100);//this.scene.add(lights[0]);\n//this.scene.add(lights[1]);\n//this.scene.add(lights[2]);\n};_this.startAnimationLoop=function(){_this.requestID=window.requestAnimationFrame(_this.startAnimationLoop);var now=new Date().getTime();if(!_this.simPaused){// Handle delivery of messages\n_this.time+=now-_this.lastLoopTime;_this.setState({time:_this.time});var remove=[];for(var i=0;i<_this.messages.length;i++){if(_this.messages[i].time<_this.time){if(_this.debugNetwork)console.log(\"Routing message: \"+JSON.stringify(_this.messages[i]));if(typeof _this.messages[i].to==='undefined'){console.log(\"Invalid message: \"+JSON.stringify(_this.messages[i]));}else{_this.agents[_this.messages[i].to].receiveMessage(_this.messages[i]);}remove.push(i);}}for(var _i=0;_i<remove.length;_i++){_this.messages.splice(remove[_i]-_i,1);}// Handle clocking of agents\n// TODO: Likely we should randomally walk for better simulation of real world parallelism\nfor(var _i2=0;_i2<_this.agents.length;_i2++){_this.agents[_i2].loop(_this.time);}//this.sleep(50);  // TODO: Remove this after debugging\nif(_this.time>_this.pauseTime){_this.simPaused=true;_this.renderer.render(_this.scene,_this.camera);_this.pauseTime=Number.MAX_SAFE_INTEGER;return;}}_this.lastLoopTime=now;delta+=clock.getDelta();if(delta<interval){return;}_this.renderer.render(_this.scene,_this.camera);delta=delta%interval;};_this.handleWindowResize=function(){var width=_this.el.clientWidth;var height=_this.el.clientHeight;_this.renderer.setSize(width,height);_this.camera.aspect=width/height;// Note that after making changes to most of camera properties you have to call\n// .updateProjectionMatrix for the changes to take effect.\n_this.camera.updateProjectionMatrix();};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){this.worldSetup();this.agentSetup(this.agentParams);this.sceneSetup();this.addCustomSceneObjects();this.startAnimationLoop();window.addEventListener(\"resize\",this.handleWindowResize);this.setState({time:0});// Render once so we see the initial pattern\nthis.renderer.render(this.scene,this.camera);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener(\"resize\",this.handleWindowResize);window.cancelAnimationFrame(this.requestID);this.controls.dispose();}// Setup the world environment.\n},{key:\"calcAgentNeighbors\",// Calculate agent neighbors based on distance.\nvalue:function calcAgentNeighbors(max){if(this.debugNeighbors)console.log(\"Calculating neighbors\");for(var agentIdx=0;agentIdx<this.agents.length;agentIdx++){if(this.debugNeighbors)console.log(\"Agent: \"+agentIdx);var distances=[];var agent=this.agents[agentIdx];var pos=agent.getPosition();for(var i=0;i<this.agents.length;i++){if(i!==agentIdx){var dist=this.agents[i].getPosition().distanceToSquared(pos);distances.push({dist:dist,agentIdx:i});}}distances.sort(function(a,b){return a.dist-b.dist;});if(this.debugNeighbors)console.log(JSON.stringify(distances));//console.log(distances);\nvar neighbors=[];var len=Math.min(max,distances.length);for(var _i3=0;_i3<len;_i3++){neighbors[_i3]=distances[_i3].agentIdx;}if(this.debugNeighbors)console.log(JSON.stringify(neighbors));this.agents[agentIdx].setNeighbors(neighbors);}if(this.showNeighborsFor!==-1){var _neighbors=this.agents[this.showNeighborsFor].getNeighbors();for(var _i4=0;_i4<_neighbors.length;_i4++){this.agents[_neighbors[_i4]].setMarked(true);}}}},{key:\"sleep\",value:function sleep(milliseconds){var date=Date.now();var currentDate=null;do{currentDate=Date.now();}while(currentDate-date<milliseconds);}},{key:\"sendMessage\",value:function sendMessage(from,to,msg){if(this.debugNetwork){console.log(\"Send message. from: \"+from+\" to: \"+to+\" msg: \"+JSON.stringify(msg));}if(typeof from===\"undefined\"){throw new Error(\"From is required\");}if(typeof to===\"undefined\"){throw new Error(\"To is required\");}this.messages.push({from:from,to:to,msg:msg,time:this.time+Math.random()*transmissionDelayMax});}},{key:\"handleSimPause\",value:function handleSimPause(){this.simPaused=true;}},{key:\"handleSimPlay\",value:function handleSimPlay(){this.simPaused=false;this.lastLoopTime=new Date().getTime();}// Play the sim for one cycle time\n},{key:\"handleSimStep\",value:function handleSimStep(){this.simPaused=false;this.lastLoopTime=new Date().getTime();this.pauseTime=this.time+this.agentParams.cycleTime;}},{key:\"handleSimReset\",value:function handleSimReset(){this.simPaused=true;this.time=0;this.setState({time:this.time});this.lastLoopTime=new Date().getTime();this.messages=[];while(this.scene.children.length>0){this.scene.remove(this.scene.children[0]);}this.agentSetup(this.agentParams);this.addCustomSceneObjects();}},{key:\"handleCameraReset\",value:function handleCameraReset(){this.controls.reset();}},{key:\"handleAgentParamsChanged\",value:function handleAgentParamsChanged(params){console.log(\"Params changed: \"+JSON.stringify(params));this.agentParams=_objectSpread(_objectSpread({},this.agentParams),params);this.handleSimReset();}},{key:\"markNeighbors\",value:function markNeighbors(agentIdx){// clear old\nfor(var i=0;i<this.agents.length;i++){this.agents[i].setMarked(false);}var neighbors=this.agents[agentIdx].getNeighbors();for(var _i5=0;_i5<neighbors.length;_i5++){this.agents[neighbors[_i5]].setMarked(!this.agents[neighbors[_i5]].getMarked());}}},{key:\"showAliveCount\",value:function showAliveCount(agentIdx){console.log(\"Agent: \"+agentIdx);var neighbors=this.agents[agentIdx].getNeighbors();var aliveCount=0;for(var i=0;i<neighbors.length;i++){console.log(\"neighbor: \"+neighbors[i]+\" alive: \"+this.agents[neighbors[i]].isAlive());if(this.agents[neighbors[i]].isAlive()){aliveCount++;}}console.log(\"aliveCount: \"+aliveCount);}},{key:\"handleKeyPressed\",value:function handleKeyPressed(e){var row=9;var size=10;switch(e.key){case'0':this.markNeighbors(row*size+0);this.showAliveCount(row*size+0);break;case'1':this.markNeighbors(row*size+1);this.showAliveCount(row*size+1);break;case'2':this.markNeighbors(row*size+2);this.showAliveCount(row*size+2);break;case'3':this.markNeighbors(row*size+3);this.showAliveCount(row*size+3);break;case'4':this.markNeighbors(row*size+4);this.showAliveCount(row*size+4);break;case'5':this.markNeighbors(row*size+5);this.showAliveCount(row*size+5);break;case'6':this.markNeighbors(row*size+6);this.showAliveCount(row*size+6);break;case'7':this.markNeighbors(row*size+7);this.showAliveCount(row*size+7);break;case'8':this.markNeighbors(row*size+8);this.showAliveCount(row*size+8);break;case'9':this.markNeighbors(row*size+9);this.showAliveCount(row*size+9);break;case's':this.handleSimStep();break;case'c':for(var i=0;i<this.agents.length;i++){this.agents[i].setMarked(false);}break;default:// ignore\nbreak;}}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{style:style,ref:function ref(_ref){return _this2.el=_ref;},onKeyPress:function onKeyPress(e){return _this2.handleKeyPressed(e);},autoFocus:true}),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\"}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(SimControl,{time:this.state.time,resetAction:function resetAction(e){return _this2.handleSimReset();},pauseAction:function pauseAction(e){return _this2.handleSimPause();},playAction:function playAction(e){return _this2.handleSimPlay();},stepAction:function stepAction(e){return _this2.handleSimStep();}}),/*#__PURE__*/React.createElement(CameraControl,{resetAction:function resetAction(e){return _this2.handleCameraReset();}})),/*#__PURE__*/React.createElement(ConwayControl,Object.assign({},this.agentParams,{paramsChangedAction:function paramsChangedAction(param,val){return _this2.handleAgentParamsChanged(param,val);}}))));}}]);return App;}(Component);export default memo(App);","map":{"version":3,"sources":["C:/cygwin64/home/giles/projs/personal/getalife/website/giles7777.github.io/src/App.js"],"names":["React","Component","memo","THREE","OrbitControls","World","ConwayAgent","ConwayControl","SimControl","CameraControl","style","height","maxWidth","delta","clock","Clock","interval","transmissionDelayMax","App","state","debugNetwork","debugNeighbors","showNeighborsFor","messages","simPaused","pauseTime","Number","MAX_SAFE_INTEGER","time","lastLoopTime","Date","getTime","agentParams","startPattern","size","cycleTime","stateSendTime","spontaneousGeneration","resurrectionChance","worldSetup","world","agentSetup","params","id","random","chance","quadpole","blank","corners","cool1","toad","blinker","beacon","pulsar","test","pattern","console","log","length","agents","y","x","alive","px","py","Math","agent","PI","sceneSetup","width","el","clientWidth","clientHeight","scene","Scene","camera","PerspectiveCamera","position","z","controls","renderer","WebGLRenderer","setSize","appendChild","domElement","addCustomSceneObjects","n","add","getMesh","calcAgentNeighbors","lights","PointLight","set","startAnimationLoop","requestID","window","requestAnimationFrame","now","setState","remove","i","JSON","stringify","to","receiveMessage","push","splice","loop","render","getDelta","handleWindowResize","aspect","updateProjectionMatrix","addEventListener","removeEventListener","cancelAnimationFrame","dispose","max","agentIdx","distances","pos","getPosition","dist","distanceToSquared","sort","a","b","neighbors","len","min","setNeighbors","getNeighbors","setMarked","milliseconds","date","currentDate","from","msg","Error","children","reset","handleSimReset","getMarked","aliveCount","isAlive","e","row","key","markNeighbors","showAliveCount","handleSimStep","ref","handleKeyPressed","display","handleSimPause","handleSimPlay","handleCameraReset","param","val","handleAgentParamsChanged"],"mappings":"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","sourcesContent":["import React, { Component, memo } from \"react\";\nimport * as THREE from \"three\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport { World } from \"./World\"\nimport { ConwayAgent,ConwayControl } from \"./ConwayAgent\"\nimport SimControl from \"./SimControl\"\nimport CameraControl from \"./CameraControl\"\n\nconst style = {\n  height: 512,\n  maxWidth: 1024\n};\n\nlet delta = 0;\nlet clock = new THREE.Clock();\nlet interval = 1 / 30;\n\nconst transmissionDelayMax = 0;  // ms max\n\nclass App extends Component {\n  state = {}\n  debugNetwork = false;\n  debugNeighbors = false;\n  showNeighborsFor = -1;\n  messages = [];\n  simPaused = true;\n  pauseTime = Number.MAX_SAFE_INTEGER;\n  time = 0;  // Simulation time\n  lastLoopTime = new Date().getTime();\n\n  agentParams = {startPattern:\"test\", size: 10,\n    cycleTime: 400,\n    stateSendTime: 50,\n    spontaneousGeneration: 0.001*0,\n    resurrectionChance: 0.5*0};\n\n  componentDidMount() {\n    this.worldSetup();\n    this.agentSetup(this.agentParams);\n    this.sceneSetup();\n    this.addCustomSceneObjects();\n    this.startAnimationLoop();\n    window.addEventListener(\"resize\", this.handleWindowResize);\n\n    this.setState({time:0});\n\n    // Render once so we see the initial pattern\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.handleWindowResize);\n    window.cancelAnimationFrame(this.requestID);\n    this.controls.dispose();\n  }\n\n  // Setup the world environment.\n  worldSetup = () => {\n    this.world = new World();\n  };\n\n  // Setup the agents\n  agentSetup = (params) => {\n    let id = 0;\n\n    let random = false;\n    let chance = 0.4;\n    let quadpole = [\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,1,1,0,0,0,0,0,0,0],\n      [0,1,0,1,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,1,0,1,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,1,0,1,0,0],\n      [0,0,0,0,0,0,1,1,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n    ];\n\n    let blank = [\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n    ];\n\n    let corners = [\n      [1,1,0,0,0,0,0,0,1,1],\n      [1,0,0,0,0,0,0,0,0,1],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [1,0,0,0,0,0,0,0,0,1],\n      [1,1,0,0,0,0,0,0,1,1],\n    ];\n    let cool1 = [\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,1,1,0,0,0,0],\n      [0,0,0,1,1,1,1,0,0,0],\n      [0,0,0,0,1,1,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n    ];\n\n    let toad = [\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,1,1,1,0,0,0],\n      [0,0,0,1,1,1,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n    ];\n\n    let blinker = [\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,1,0,0,0,0],\n      [0,0,0,0,0,1,0,0,0,0],\n      [0,0,0,0,0,1,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n    ];\n\n    let beacon = [\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,1,1,0,0,0,0,0],\n      [0,0,0,1,1,0,0,0,0,0],\n      [0,0,0,0,0,1,1,0,0,0],\n      [0,0,0,0,0,1,1,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n    ];\n\n    let pulsar = [\n      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n      [0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],\n      [0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],\n      [0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],\n      [0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0],\n      [0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],\n      [0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],\n      [0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0],\n      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\n    ];\n\n    let test = [\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,1,1,0,0,0,0,0],\n      [0,0,0,1,1,0,0,0,0,0],\n      [0,0,0,0,0,1,1,0,0,0],\n      [0,0,0,0,0,1,1,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n      [0,0,0,0,0,0,0,0,0,0],\n    ];\n\n    let pattern;\n\n    if (params.startPattern === \"random\") {\n      random = true;\n    } else {\n      switch(params.startPattern) {\n        case \"quadpole\":\n          pattern = quadpole;\n          break;\n        case \"blank\":\n          pattern = blank;\n          break;\n        case \"test\":\n          pattern = test;\n          break;\n        case \"corners\":\n          pattern = corners;\n          break;\n        case \"toad\":\n          pattern = toad;\n          break;\n        case \"beacon\":\n          pattern = beacon;\n          break;\n        case \"blinker\":\n          pattern = blinker;\n          break;\n        case \"pulsar\":\n          pattern = pulsar;\n          break;\n        default:\n          console.log(\"Unknown pattern\");\n          pattern = test;\n          break;\n      }\n    }\n\n    let size = params.size;\n    if (size < pattern.length) {\n      size = pattern.length;\n    }\n\n    this.agents = [];\n\n    for(let y=0; y < size; y++) {\n      for(let x=0; x < size; x++) {\n        let alive = true;\n\n        let px = x;\n        let py = y;\n\n        if (random) {\n          alive = Math.random() < chance;\n        } else {\n          px = x;\n          py = size - y - 1;\n\n          alive = pattern[y][x] === 1;\n        }\n\n        const agent = new ConwayAgent(THREE,this,id++,this.world,0.1,px-size/2,py-size/2,0,Math.PI/2,0,0,params,alive);\n        //console.log(\"agent: \" + (id-1) + \" id: \" + (y * size + x) + \" x: \" + x + \" y: \" + y + \" alive: \" + alive);\n        this.agents[y * size + x] = agent;\n      }\n    }\n  };\n\n  // Standard scene setup in Three.js. Check \"Creating a scene\" manual for more information\n  // https://threejs.org/docs/#manual/en/introduction/Creating-a-scene\n  sceneSetup = () => {\n    // get container dimensions and use them for scene sizing\n    const width = this.el.clientWidth;\n    const height = this.el.clientHeight;\n\n    this.scene = new THREE.Scene();\n    this.camera = new THREE.PerspectiveCamera(\n      75, // fov = field of view\n      width / height, // aspect ratio\n      0.1, // near plane\n      1000.0 // far plane\n    );\n    this.camera.position.z = 10; // is used here to set some distance from a cube that is located at z = 0\n    // OrbitControls allow a camera to orbit around the object\n    // https://threejs.org/docs/#examples/controls/OrbitControls\n\n    this.controls = new OrbitControls(this.camera, this.el);\n    this.renderer = new THREE.WebGLRenderer();\n    this.renderer.setSize(width, height);\n    this.el.appendChild(this.renderer.domElement); // mount using React ref\n\n  };\n\n  // Here should come custom code.\n  // Code below is taken from Three.js BoxGeometry example\n  // https://threejs.org/docs/#api/en/geometries/BoxGeometry\n  addCustomSceneObjects = () => {\n    for(let n=0; n < this.agents.length; n++) {\n      this.scene.add(this.agents[n].getMesh());\n    }\n\n    this.calcAgentNeighbors(8);\n\n    const lights = [];\n    lights[0] = new THREE.PointLight(0xffffff, 1, 0);\n    lights[1] = new THREE.PointLight(0xffffff, 1, 0);\n    lights[2] = new THREE.PointLight(0xffffff, 1, 0);\n\n    lights[0].position.set(0, 200, 0);\n    lights[1].position.set(100, 200, 100);\n    lights[2].position.set(-100, -200, -100);\n\n    //this.scene.add(lights[0]);\n    //this.scene.add(lights[1]);\n    //this.scene.add(lights[2]);\n  };\n\n  // Calculate agent neighbors based on distance.\n  calcAgentNeighbors(max) {\n    if (this.debugNeighbors) console.log(\"Calculating neighbors\");\n\n    for(let agentIdx=0; agentIdx < this.agents.length; agentIdx++) {\n      if (this.debugNeighbors) console.log(\"Agent: \" + agentIdx);\n      let distances = [];\n\n      let agent = this.agents[agentIdx];\n      let pos = agent.getPosition();\n\n      for (let i = 0; i < this.agents.length; i++) {\n        if (i !== agentIdx) {\n          let dist = this.agents[i].getPosition().distanceToSquared(pos);\n          distances.push({dist: dist, agentIdx: i});\n        }\n      }\n\n      distances.sort(function (a, b) {\n        return a.dist - b.dist;\n      });\n      if (this.debugNeighbors) console.log(JSON.stringify(distances));\n\n      //console.log(distances);\n      let neighbors = [];\n      let len = Math.min(max,distances.length);\n\n      for(let i=0; i < len; i++) {\n        neighbors[i] = distances[i].agentIdx;\n      }\n\n      if (this.debugNeighbors) console.log(JSON.stringify(neighbors));\n      this.agents[agentIdx].setNeighbors(neighbors);\n    }\n\n    if (this.showNeighborsFor !== -1) {\n      let neighbors = this.agents[this.showNeighborsFor].getNeighbors();\n      for(let i=0; i < neighbors.length; i++) {\n        this.agents[neighbors[i]].setMarked(true);\n      }\n    }\n  }\n\n  startAnimationLoop = () => {\n    this.requestID = window.requestAnimationFrame(this.startAnimationLoop);\n\n    let now = new Date().getTime();\n\n    if (!this.simPaused) {\n      // Handle delivery of messages\n      this.time += now - this.lastLoopTime;\n      this.setState({time:this.time});\n\n      let remove = [];\n      for (let i = 0; i < this.messages.length; i++) {\n        if (this.messages[i].time < this.time) {\n          if (this.debugNetwork) console.log(\"Routing message: \" + JSON.stringify(this.messages[i]));\n          if (typeof this.messages[i].to === 'undefined') {\n            console.log(\"Invalid message: \" + JSON.stringify(this.messages[i]))\n          } else {\n            this.agents[this.messages[i].to].receiveMessage(this.messages[i]);\n          }\n          remove.push(i);\n        }\n      }\n\n      for (let i = 0; i < remove.length; i++) {\n        this.messages.splice(remove[i] - i, 1);\n      }\n\n      // Handle clocking of agents\n      // TODO: Likely we should randomally walk for better simulation of real world parallelism\n      for (let i = 0; i < this.agents.length; i++) {\n        this.agents[i].loop(this.time);\n      }\n\n      //this.sleep(50);  // TODO: Remove this after debugging\n      if (this.time > this.pauseTime) {\n        this.simPaused = true;\n        this.renderer.render(this.scene, this.camera);\n        this.pauseTime = Number.MAX_SAFE_INTEGER;\n        return;\n      }\n    }\n\n    this.lastLoopTime = now;\n    delta += clock.getDelta();\n    if (delta < interval) {\n      return;\n    }\n\n    this.renderer.render(this.scene, this.camera);\n    delta = delta % interval;\n  };\n\n  sleep(milliseconds) {\n    const date = Date.now();\n    let currentDate = null;\n    do {\n      currentDate = Date.now();\n    } while (currentDate - date < milliseconds);\n  }\n\n  handleWindowResize = () => {\n    const width = this.el.clientWidth;\n    const height = this.el.clientHeight;\n\n    this.renderer.setSize(width, height);\n    this.camera.aspect = width / height;\n\n    // Note that after making changes to most of camera properties you have to call\n    // .updateProjectionMatrix for the changes to take effect.\n    this.camera.updateProjectionMatrix();\n  };\n\n  sendMessage(from,to,msg) {\n    if (this.debugNetwork) {\n      console.log(\"Send message. from: \" + from + \" to: \" + to + \" msg: \" + JSON.stringify(msg));\n    }\n\n    if (typeof from === \"undefined\") {\n      throw new Error(\"From is required\");\n    }\n    if (typeof to === \"undefined\") {\n      throw new Error(\"To is required\");\n    }\n\n    this.messages.push({from:from,to:to,msg:msg,time: this.time + Math.random() * transmissionDelayMax});\n  }\n\n  handleSimPause() {\n    this.simPaused = true;\n  }\n\n  handleSimPlay() {\n    this.simPaused = false;\n    this.lastLoopTime = new Date().getTime();\n  }\n\n  // Play the sim for one cycle time\n  handleSimStep() {\n    this.simPaused = false;\n    this.lastLoopTime = new Date().getTime();\n    this.pauseTime = this.time + this.agentParams.cycleTime;\n  }\n\n  handleSimReset() {\n    this.simPaused = true;\n    this.time = 0;\n    this.setState({time:this.time});\n    this.lastLoopTime = new Date().getTime();\n    this.messages = [];\n\n    while(this.scene.children.length > 0){\n      this.scene.remove(this.scene.children[0]);\n    }\n\n    this.agentSetup(this.agentParams);\n    this.addCustomSceneObjects();\n  }\n\n  handleCameraReset() {\n    this.controls.reset();\n  }\n\n  handleAgentParamsChanged(params) {\n    console.log(\"Params changed: \" + JSON.stringify(params));\n\n    this.agentParams = {...this.agentParams,...params};\n\n    this.handleSimReset();\n  }\n\n  markNeighbors(agentIdx) {\n    // clear old\n    for(let i=0; i < this.agents.length; i++) {\n      this.agents[i].setMarked(false);\n    }\n\n    let neighbors = this.agents[agentIdx].getNeighbors();\n    for(let i=0; i < neighbors.length; i++) {\n      this.agents[neighbors[i]].setMarked(!this.agents[neighbors[i]].getMarked());\n    }\n  }\n\n  showAliveCount(agentIdx) {\n    console.log(\"Agent: \" + agentIdx);\n    const neighbors = this.agents[agentIdx].getNeighbors();\n    let aliveCount = 0;\n    for(let i=0; i < neighbors.length; i++) {\n      console.log(\"neighbor: \" + neighbors[i] + \" alive: \" + this.agents[neighbors[i]].isAlive());\n      if (this.agents[neighbors[i]].isAlive()) {\n        aliveCount++;\n      }\n    }\n    console.log(\"aliveCount: \" + aliveCount);\n\n  }\n\n  handleKeyPressed(e) {\n    let row = 9;\n    let size = 10;\n\n    switch(e.key) {\n      case '0':\n        this.markNeighbors(row * size + 0);\n        this.showAliveCount(row * size + 0);\n        break;\n      case '1':\n        this.markNeighbors(row * size + 1);\n        this.showAliveCount(row * size + 1);\n        break;\n      case '2':\n        this.markNeighbors(row * size + 2);\n        this.showAliveCount(row * size + 2);\n        break;\n      case '3':\n        this.markNeighbors(row * size + 3);\n        this.showAliveCount(row * size + 3);\n        break;\n      case '4':\n        this.markNeighbors(row * size + 4);\n        this.showAliveCount(row * size + 4);\n        break;\n      case '5':\n        this.markNeighbors(row * size + 5);\n        this.showAliveCount(row * size + 5);\n        break;\n      case '6':\n        this.markNeighbors(row * size + 6);\n        this.showAliveCount(row * size + 6);\n        break;\n      case '7':\n        this.markNeighbors(row * size + 7);\n        this.showAliveCount(row * size + 7);\n        break;\n      case '8':\n        this.markNeighbors(row * size + 8);\n        this.showAliveCount(row * size + 8);\n        break;\n      case '9':\n        this.markNeighbors(row * size + 9);\n        this.showAliveCount(row * size + 9);\n        break;\n      case 's':\n        this.handleSimStep();\n        break;\n      case 'c':\n        for(let i=0; i < this.agents.length; i++) {\n          this.agents[i].setMarked(false);\n        }\n        break;\n      default:\n        // ignore\n        break;\n    }\n  }\n\n  render() {\n    return <div>\n      <div style={style} ref={ref => (this.el = ref)} onKeyPress = {e => this.handleKeyPressed(e) } autoFocus />\n      <div style={{\n        display:\"flex\"\n      }} >\n        <div>\n        <SimControl time = {this.state.time} resetAction={e => this.handleSimReset()} pauseAction={e => this.handleSimPause() } playAction={e => this.handleSimPlay() } stepAction={e => this.handleSimStep() }/>\n        <CameraControl resetAction={e => this.handleCameraReset()} />\n        </div>\n        <ConwayControl {...this.agentParams} paramsChangedAction = {(param,val) => this.handleAgentParamsChanged(param,val) } />\n      </div>\n    </div>\n  }\n}\n\nexport default memo(App);\n"]},"metadata":{},"sourceType":"module"}